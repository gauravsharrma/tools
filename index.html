<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Tool App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Merriweather', serif;
        }
        .active-tool {
            background-color: #3b82f6; /* blue-500 */
            color: white !important; /* Use important to override hover styles */
        }
        /* A little fade-in for the loaded content */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .tool-content {
            animation: fadeIn 0.3s ease-in-out;
        }
    </style>
</head>
<body class="bg-slate-100 h-screen overflow-hidden">

    <div class="flex h-full">
        <div class="w-1/4 bg-white border-r border-slate-200 p-6 flex flex-col">
            <h1 class="text-2xl font-bold text-slate-800 mb-6">Tools</h1>
            <div class="mb-4">
                <input type="text" id="toolSearch" onkeyup="filterTools()" placeholder="Search tools..." class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <nav id="toolList" class="flex-grow">
                <ul>
                    <li>
                        <a href="#" onclick="loadTool('calculator.html', this)" class="block p-3 rounded-lg font-semibold text-slate-700 hover:bg-slate-200">Calculator</a>
                    </li>
                    <li>
                        <a href="#" onclick="loadTool('word-counter.html', this)" class="block p-3 rounded-lg font-semibold text-slate-700 hover:bg-slate-200">Character & Word Count</a>
                    </li>
                </ul>
            </nav>
            <div class="text-xs text-center text-slate-400 mt-4">
                <p>Dubai, UAE</p>
                <p id="currentTime"></p>
            </div>
        </div>

        <main id="content-frame" class="w-3/4 p-8 overflow-y-auto">
            </main>
    </div>

<script>
    // --- GLOBAL APP LOGIC ---

    // Function to fetch and load tool HTML into the content frame
    async function loadTool(toolFile, element) {
        try {
            const response = await fetch(toolFile);
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            const html = await response.text();
            document.getElementById('content-frame').innerHTML = html;
            
            // After loading the HTML, initialize its specific JavaScript
            if (toolFile === 'calculator.html') {
                initializeCalculator();
            } else if (toolFile === 'word-counter.html') {
                initializeWordCounter();
            }

            // Update the active link style in the sidebar
            document.querySelectorAll('#toolList a').forEach(link => {
                link.classList.remove('active-tool');
            });
            element.classList.add('active-tool');

        } catch (error) {
            document.getElementById('content-frame').innerHTML = `<p class="text-center text-red-500">Error: Could not load ${toolFile}.</p>`;
            console.error('Fetch error:', error);
        }
    }

    // Load the calculator by default when the page first loads
    document.addEventListener('DOMContentLoaded', () => {
        const firstToolLink = document.querySelector('#toolList a');
        if(firstToolLink) {
            loadTool('calculator.html', firstToolLink);
        }
        updateTime();
        setInterval(updateTime, 1000);
    });

    function filterTools() {
        const input = document.getElementById('toolSearch');
        const filter = input.value.toUpperCase();
        const ul = document.getElementById('toolList');
        const li = ul.getElementsByTagName('li');

        for (let i = 0; i < li.length; i++) {
            const a = li[i].getElementsByTagName("a")[0];
            const txtValue = a.textContent || a.innerText;
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
                li[i].style.display = "";
            } else {
                li[i].style.display = "none";
            }
        }
    }
    
    // --- CURRENT TIME LOGIC ---
    function updateTime() {
        const timeElement = document.getElementById('currentTime');
        if (!timeElement) return;
        const now = new Date();
        const options = { timeZone: 'Asia/Dubai', hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true };
        timeElement.textContent = now.toLocaleTimeString('en-US', options);
    }

    // --- TOOL-SPECIFIC JAVASCRIPT INITIALIZERS ---

    // Initializes the calculator's event listeners after its HTML is loaded
    function initializeCalculator() {
        const calcDisplay = document.getElementById('calcDisplay');
        let currentInput = '0';

        // Attach event listeners to all calculator buttons
        document.querySelectorAll('.calc-btn').forEach(button => {
            button.addEventListener('click', () => {
                const action = button.dataset.action;
                const value = button.textContent;
                
                if (!action) { // It's a number or operator
                    appendInput(value);
                } else if (action === 'clear') {
                    clearDisplay();
                } else if (action === 'delete') {
                    deleteLast();
                } else if (action === 'calculate') {
                    calculateResult();
                }
            });
        });

        const appendInput = (value) => {
            const operators = ['+', '-', 'x', '/'];
            const lastChar = currentInput.slice(-1);
            if (operators.includes(lastChar) && operators.includes(value)) return;
            const segments = currentInput.split(/[+\-x/]/);
            if (value === '.' && segments[segments.length - 1].includes('.')) return;
            currentInput = (currentInput === '0' && value !== '.') ? value : currentInput + value;
            updateCalcDisplay(currentInput);
        };

        const clearDisplay = () => {
            currentInput = '0';
            updateCalcDisplay(currentInput);
        };

        const deleteLast = () => {
            currentInput = currentInput.slice(0, -1) || '0';
            updateCalcDisplay(currentInput);
        };

        const calculateResult = () => {
            try {
                let expression = currentInput.replace(/x/g, '*');
                const result = new Function('return ' + expression)();
                currentInput = String(Number(result.toFixed(10)));
                updateCalcDisplay(currentInput);
            } catch (error) {
                currentInput = 'Error';
                updateCalcDisplay(currentInput);
                setTimeout(() => { currentInput = '0'; updateCalcDisplay(currentInput); }, 1500);
            }
        };

        const updateCalcDisplay = (value) => {
            calcDisplay.textContent = value;
        };
    }

    // Initializes the word counter's event listeners after its HTML is loaded
    function initializeWordCounter() {
        const textInput = document.getElementById('textInput');
        const wordCountDisplay = document.getElementById('wordCount');
        const charCountDisplay = document.getElementById('charCount');

        textInput.addEventListener('input', () => {
            const text = textInput.value;
            charCountDisplay.textContent = text.length;
            const words = text.trim().split(/\s+/).filter(word => word !== '');
            wordCountDisplay.textContent = text.trim() === '' ? 0 : words.length;
        });
    }
</script>
</body>
</html>